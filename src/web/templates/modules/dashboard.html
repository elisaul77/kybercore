<section id="dashboard" class="space-y-6 p-4 bg-gradient-to-br from-gray-50 to-blue-50 min-h-screen">
  <!-- Header con notificaciones en tiempo real -->
  <div class="flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4">
    <div class="flex items-center gap-4">
      <h1 class="text-4xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent">
        Dashboard KyberCore
      </h1>
      <div class="flex items-center gap-2">
        <div class="w-3 h-3 bg-green-400 rounded-full animate-pulse"></div>
        <span class="text-sm text-gray-600">Sistema Online</span>
      </div>
    </div>
    <div class="flex flex-wrap gap-2">
      <button class="px-4 py-2 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-lg hover:from-blue-600 hover:to-blue-700 text-sm font-medium shadow-lg transform hover:scale-105 transition-all duration-200 flex items-center gap-2">
        <span class="animate-spin">🔄</span> Actualizar
      </button>
      <button class="px-4 py-2 bg-gradient-to-r from-purple-500 to-purple-600 text-white rounded-lg hover:from-purple-600 hover:to-purple-700 text-sm font-medium shadow-lg transform hover:scale-105 transition-all duration-200 flex items-center gap-2">
        <span>⚙️</span> Configurar
      </button>
    </div>
  </div>

  <!-- Importar KPIs -->
  {% include "modules/dashboard/kpi.html" %}

 

  <!-- Importar Controles de la cola de impresión -->
  {% include "modules/dashboard/controls.html" %}

  <!-- Contenido principal: izquierda (proyectos + cola) / derecha (eventos + alertas) -->
  <div class="grid grid-cols-1 xl:grid-cols-3 gap-6">
    <!-- Columna izquierda: proyectos en curso + activas + cola + recomendaciones IA -->
    <div class="xl:col-span-2 space-y-6">
      <!-- Centro de Gestión de Proyectos -->
    {% include "modules/dashboard/project_management.html" %}

      <!-- Cola de impresión inteligente -->
      {% include "modules/dashboard/print_queue.html" %}

      <!-- Recomendaciones IA -->
      {% include "modules/dashboard/ai_suggestions.html" %}
    </div>

    <!-- Columna derecha: eventos + alertas -->
    {% include "modules/dashboard/activity_alerts.html" %}
  </div>

  <!-- Vista de flota panorámica mejorada -->
  {% include "modules/dashboard/fleet_overview.html" %}
</section>

<!-- Script específico del dashboard -->
<script src="{{ url_for('static', path='js/dashboard.js') }}"></script>
<script src="{{ url_for('static', path='js/project_management.js') }}"></script>

<script>
// Configuración inicial del dashboard
document.addEventListener('DOMContentLoaded', function() {
    // Configurar datos de ejemplo para proyectos
    const projectCards = document.querySelectorAll('.border-l-4');
    projectCards.forEach((card, index) => {
        const projectNames = ['AlphaCAM', 'SensorHub', 'BetaRig'];
        if (index < projectNames.length) {
            card.setAttribute('data-project-card', projectNames[index]);
        }
    });
    
    console.log('Dashboard inicializado con funcionalidad de proyectos integrada');
});

// Configuración de WebSocket para actualizaciones en tiempo real (opcional)
function initWebSocket() {
    if (typeof WebSocket !== 'undefined') {
        const ws = new WebSocket(`ws://${window.location.host}/ws/fleet`);
        
        ws.onmessage = function(event) {
            const data = JSON.parse(event.data);
            if (window.dashboardManager) {
                window.dashboardManager.updateKPIsWithData(data);
            }
        };
        
        ws.onerror = function(error) {
            console.log('WebSocket error:', error);
        };
    }
}

// Inicializar WebSocket después de un breve delay
setTimeout(initWebSocket, 2000);
</script>
